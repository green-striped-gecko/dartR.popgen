% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gl.run.popcluster.r
\name{gl.run.popcluster}
\alias{gl.run.popcluster}
\title{Creates an input file for the program PopCluster and runs it if
PopCluster is installed (can be installed at: https://www.zsl.org/about-zsl/resources/software/popcluster)}
\usage{
gl.run.popcluster(
  x,
  popcluster.path,
  output.path,
  filename = "output",
  minK,
  maxK,
  rep,
  search_relate = 0,
  allele_freq = 1,
  PopData,
  PopFlag = 0,
  model = 2,
  location,
  loc_admixture = 1,
  relatedness = 0,
  kinship = 0,
  pr_allele_freq = 2,
  cleanup = TRUE,
  plot.dir = NULL,
  plot.out = TRUE,
  plot.file = NULL,
  plot_theme = theme_dartR(),
  verbose = 2
)
}
\arguments{
\item{x}{Name of the genlight object containing the SNP data [required]}

\item{popcluster.path}{absolute path to the directory that contain the PopCluster program 
(eg: c:/User/bin/PopCluster/) [required]}

\item{output.path}{Path to store the parameter file and input data [required]}

\item{filename}{Prefix of all the files that will be produced [default “output”]}

\item{minK}{Minimum K [required]}

\item{maxK}{Maximum K [required]}

\item{rep}{Number of replicates runs per K [required]}

\item{search_relate}{Search using assignment_prob/relatedness: 0=N, 1=Y [default 0]}

\item{allele_freq}{Output allele frequency: 0=N, 1=Y [default 1]}

\item{PopData}{PopData available: 0=N, 1=Y [required]}

\item{PopFlag}{PopFlag available: 0=N, 1=Y. [default 0]}

\item{model}{1=Mixture, 2=Admixture, 3=Hybridyzation, 4=Migration model [default 2]}

\item{location}{Individual location data available: 0=N, 1=Y [required]}

\item{loc_admixture}{Infer locus admixture: 0=N, 1=Y [default 1]}

\item{relatedness}{Compute relatedness = 0=No, 1=Wang, 2=LynchRitland [default 0]}

\item{kinship}{Estimate kinship: 0=N, 1=Y [default 0]}

\item{pr_allele_freq}{0=Undefined, 1=equal, 2=unequal prior allele freq [default 2]}

\item{cleanup}{clean data in tmp [default  TRUE]}

\item{plot.dir}{Directory in which to save files [default = working directory]}

\item{plot.out}{Specify if plot is to be produced [default TRUE].}

\item{plot.file}{Name for the RDS binary file to save (base name only, exclude
extension) [default NULL]}

\item{plot_theme}{Theme of the plot [default theme_dartR()]}

\item{verbose}{Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
[default 2 or as specified using gl.set.verbosity].}
}
\value{
The plot of likelihood, DLK1, DLK2, FST.FIS, best run, Q-matrices of PopCluster,
}
\description{
This function infers the population admixture

If you specify a directory for the PopCluster executable file, then the
script will create the input file (DataForm=0) from the SNP data then run PopCluster.

Refer to the PopCluster manual for further information on the parameters to
set
-- ##########################################
}
\examples{
\dontrun{
m <- gl.run.popcluster(x=bandicoot.gl, popcluster.path="/User/PopCluster/Bin/",
output.path="/User/Documents/Output/",
minK=1, maxK=3, 
rep=10, PopData=1, location=1)
Q <- gl.plot.popcluster(pop_cluster_result=m, plot.K = 3, ind_name=T)
gl.map.popcluster(x = bandicoot.gl, qmat = Q)
# move population 4 (out of 5) 0.5 degrees to the right and populations 1
# 0.3 degree to the north of the map.
mp <- data.frame(lon=c(0,0,0,0.5,0), lat=c(-0.3,0,0,0,0))
gl.map.popcluster(bandicoot.gl, qmat=Q, movepops=mp)
}
Wrapper function to run PopCluster

}
\references{
\itemize{
\item Wang, J. (2022). Fast and accurate population admixture inference 
from genotype data from a few microsatellites to millions of SNPs. Heredity, 129(2), 79-92.
}
}
\author{
Custodian: Ching Ching Lau -- Post to
 \url{https://groups.google.com/d/forum/dartr}
}
