% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gl.DNADot.r
\name{gl.DNADot}
\alias{gl.DNADot}
\title{Population size estimates using DNADot approach}
\usage{
gl.DNADot(
  x = NULL,
  gen.file = NULL,
  header = FALSE,
  nonGenCols = NULL,
  jj = 0.7,
  minNtry,
  ppinc = 0.05,
  validate = TRUE,
  pvalidate = 0.5,
  n.cores = "auto",
  outfile = "DNADot_out.csv",
  outpath = tempdir(),
  verbose = NULL
)
}
\arguments{
\item{x}{A genlight or genind object}

\item{gen.file}{Fully qualified path(s) (i.e. full path) to the genotype files
if \code{is.null(x) == TRUE}. Ignored if \code{is.null(x) == FALSE}}

\item{header}{Whether the genotype file(s) have headers. Ignored if 
\code{is.null(x) == FALSE}. [default FALSE]}

\item{nonGenCols}{The position or the column names of columns in the genotype 
files that are not genotypes. These are internally removed before analysis. 
Ignored if \code{is.null(x) == FALSE}}

\item{jj}{The proportion of samples to be used for the JackKnife.}

\item{minNtry}{The minimum population size to be used for estimates.}

\item{ppinc}{The starting and interval of the allele frequencies. The sequence 
of values attempted is determined using \code{seq(ppinc, 1 - ppinc, by = ppinc)}}

\item{validate}{Whether calculations should be repeated with a subset of of the 
data to validate results [default TRUE]}

\item{pvalidate}{The probability of retaining any given sample when 
\code{validate == TRUE} [default 0.5]}

\item{n.cores}{The number of cores to use. If "auto", it will 
use all but one available cores [default "auto"], if these are less than
the number of 
datasets, otherwise it will be equal to the number of datasets.}

\item{outfile}{Name of the output file.}

\item{outpath}{Path where to save output file.}
}
\description{
Function to use the DNADot method to estimate population size from genotypes.
This is a R implementation of the Matlab code provided with the original publication
(with the exception of a few data handling modifications).
}
\details{
This function can be used with \code{genlight}, \code{genind} or genotype files. 
If files are used, alleles need to be coded as integers, two columns per sample, 
one row per samples. \code{genind} objects or genotype files can be multiallelic 
(i.e. not exclusively biallelic).

The user have to provide the minimum hypothesised census size, \code{minNtry}. 
The range to be tested will be automatically scaled up to \code{3 * minNtry}. 
\code{minNtry} can be a vector or a matrix. If a vector of length == 1, that 
value is used for all populations. If a vector of \code{length(minNtry) == nPop},
each value is used for each population. If a vector of \code{length(minNtry) != nPop}
is used, it will generate an error.
If \code{minNtry} is a matrix, the values  on different rows are used for 
different populations (i.e. the first row for pop 1, the second row for pop2 
and so forth). For each populations, all the values in different columns are used 
(if there are 3 pops and a 3x3 matrix, m, is used, the analysis for population 1 
will be conducted with three values: m[1, 1], m[1, 2] and m[1, 3]. For population
2, m[2, 1], m[2, 2] and m[2, 3] will be used. Etc.).
If the matrix has only one row, the same values are used for all population.

If \code{validate == TRUE} the function will generate a dataset with a subset 
of the samples. Each sample will have a probability \code{pvalidate} to be 
included in the subset. Sherwin 2024 recommends validate the results to confirm 
that the sample size is adequate as with small sample size the results could be 
biased.
}
\author{
Carlo Pacioni, Adapted from Sherwin's MatLab code
}
