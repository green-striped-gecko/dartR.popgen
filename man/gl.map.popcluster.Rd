% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gl.map.popcluster.r
\name{gl.map.popcluster}
\alias{gl.map.popcluster}
\title{Maps a PopCluster plot using a genlight object}
\usage{
gl.map.popcluster(
  x,
  qmat,
  provider = "Esri.NatGeoWorldMap",
  scalex = 1,
  scaley = 1,
  movepops = NULL,
  pop.labels = TRUE,
  pop.labels.cex = 12
)
}
\arguments{
\item{x}{Name of the genlight object containing the coordinates in the
\code{\@other$latlon} slot to calculate the population centers [required]}

\item{qmat}{Q-matrix from a gl.plot.popcluster [required]
[from \code{\link{gl.run.popcluster}} and \code{\link{gl.plot.popcluster}}]
 [required].}

\item{provider}{Provider    passed to leaflet. Check \link[leaflet]{providers}
for a list of possible backgrounds [default "Esri.NatGeoWorldMap"].}

\item{scalex}{Scaling factor to determine the size of the bars in x direction
[default 1].}

\item{scaley}{Scaling factor to determine the size of the bars in y direction
[default 1].}

\item{movepops}{A two-dimensional data frame that allows to move the center of
the barplots manually in case they overlap. Often if populations are
horizontally close to each other. This needs to be a data.frame of the
dimensions [rows=number of populations, columns = 2 (lon/lat)]. For each
population you have to specify the x and y (lon and lat) units you want to
move the center of the plot, (see example for details) [default NULL].}

\item{pop.labels}{Switch for population labels below the parplots
[default TRUE].}

\item{pop.labels.cex}{Size of population labels [default 12].}
}
\value{
An interactive map that shows the PopCluster plots broken down by
population.

returns the map and a list of the qmat split into sorted matrices per
 population. This can be used to create your own map.
}
\description{
This function takes the output of gl.plot.popcluster (the Q matrix) and maps the
Q-matrix across using the population centers from the genlight object that
was used to run the PopCluster analysis via (\code{\link{gl.run.popcluster}})
and plots the typical PopCluster bar plots on a spatial map, providing a
barplot for each subpopulation. Therefore it requires coordinates from a
 genlight object. This kind of plots should support the interpretation of the
  spatial PopCluster of a population, but in principle is not different from
  (\code{\link{gl.plot.popcluster}})
}
\details{
Creates a mapped version of PopCluster plots. For possible background maps
check as specified via the provider:
\url{http://leaflet-extras.github.io/leaflet-providers/preview/index.html}.
You may need to adjust scalex and scaley values [default 1], as the size
depends on the scale of the map and the position of the populations.
}
\examples{
# examples need popcluster to be installed on the system
\dontrun{
m <- gl.run.popcluster(x=bandicoot.gl, popcluster.path="/User/PopCluster/Bin/",
output.path="/User/Documents/Output/",
minK=1, maxK=3, 
rep=10, PopData=1, location=1)
Q <- gl.plot.popcluster(pop_cluster_result=m, plot.K = 3, ind_name=T)
gl.map.popcluster(x = bandicoot.gl, qmat = Q)
# move population 4 (out of 5) 0.5 degrees to the right and populations 1
# 0.3 degree to the north of the map.
mp <- data.frame(lon=c(0,0,0,0.5,0), lat=c(-0.3,0,0,0,0))
gl.map.popcluster(bandicoot.gl, qmat=Q, movepops=mp)
}
}
\references{
\itemize{
\item Wang, J. (2022). Fast and accurate population admixture inference 
from genotype data from a few microsatellites to millions of SNPs. Heredity, 129(2), 79-92.

}
}
\seealso{
\code{\link{gl.run.popcluster}},
\code{\link{gl.plot.popcluster}}
}
\author{
Ching Ching Lau (Post to \url{https://groups.google.com/d/forum/dartr})
}
